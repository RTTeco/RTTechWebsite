<%@ LANGUAGE="VBSCRIPT" %>
<%


'   PROJECT HONEY POT ADDRESS DISTRIBUTION SCRIPT
'   For more information visit: http://www.projecthoneypot.org/
'   Copyright (C) 2004-2007, Unspam Technologies, Inc.
'   
'   This program is free software; you can redistribute it and/or modify
'   it under the terms of the GNU General Public License as published by
'   the Free Software Foundation; either version 2 of the License, or
'   (at your option) any later version.
'   
'   This program is distributed in the hope that it will be useful,
'   but WITHOUT ANY WARRANTY; without even the implied warranty of
'   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
'   GNU General Public License for more details.
'   
'   You should have received a copy of the GNU General Public License
'   along with this program; if not, write to the Free Software
'   Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA
'   02111-1307  USA
'   
'   If you choose to modify or redistribute the software, you must
'   completely disconnect it from the Project Honey Pot Service, as
'   specified under the Terms of Service Use. These terms are available
'   here:
'   
'   http://www.projecthoneypot.org/terms_of_service_use.php
'   
'   The required modification to disconnect the software from the
'   Project Honey Pot Service is explained in the comments below. To find the
'   instructions, search for:  *** DISCONNECT INSTRUCTIONS ***
'   
'   Generated On: Mon, 18 Jun 2007 12:12:27 -0400
'   For Domain: www.richardton-taylor.k12.nd.us
'   
'   

'   *** DISCONNECT INSTRUCTIONS ***
'   
'   You are free to modify or redistribute this software. However, if
'   you do so you must disconnect it from the Project Honey Pot Service.
'   To do this, you must delete the lines of code below located between the
'   *** START CUT HERE *** and *** FINISH CUT HERE *** comments. Under the
'   Terms of Service Use that you agreed to before downloading this software,
'   you may not recreate the deleted lines or modify this software to access
'   or otherwise connect to any Project Honey Pot server.
'   
'   *** START CUT HERE ***
'   
 REQUEST_HOST       = "hpr9.projecthoneypot.org"
 REQUEST_PORT       = "80"
 REQUEST_SCRIPT     = "/cgi/serve.php"
'   
'   *** FINISH CUT HERE ***
'   

 HPOT_TAG1          = "0d657c0930b7a3e7b9023249dd5ccd09"
 HPOT_TAG2          = "b2ea362f2e8bace96f635d2d597da92d"
 HPOT_TAG3          = "e5eff424859078ea08098d130e430833"

 CLASS_STYLE_1      = "nacruhichezo"
 CLASS_STYLE_2      = "stutos"

 DIV1               = "m3z3v2"

 VANITY_L1          = "MEMBER OF PROJECT HONEY POT"
 VANITY_L2          = "Spam Harvester Protection Network"
 VANITY_L3          = "provided by Unspam"

 DOC_TYPE1          = "<!DOCTYPE HTML PUBLIC ""-//W3C//DTD HTML 4.01 Transitional//EN"" ""http://www.w3.org/TR/html4/loose.dtd"">\n"
 HEAD1              = "<html>\n<head>\n"
 HEAD2              = "<title>Www.richardton-taylor.k12.nd.us|uncertain Entertaining</title>\n</head>\n"
 ROBOT1             = "<meta name=""robots"" content=""noindex,noarchive,follow"">\n"
 NOCOLLECT1         = "<meta name=""no-email-collection"" content=""/"">\n"
 TOP1               = "<body>\n<div align=""center"" id=""island"">\n"
 EMAIL1A            = "<a href=""mailto:"
 EMAIL1B            = """ style=""display: none;"">"
 EMAIL1C            = "</a>"
 EMAIL2A            = "<a href=""mailto:"
 EMAIL2B            = """ style=""display:none;"">"
 EMAIL2C            = "</a>"
 EMAIL3A            = "<a style=""display: none;"" href=""mailto:"
 EMAIL3B            = """>"
 EMAIL3C            = "</a>"
 EMAIL4A            = "<a style=""display:none;"" href=""mailto:"
 EMAIL4B            = """>"
 EMAIL4C            = "</a>"
 EMAIL5A            = "<a href=""mailto:"
 EMAIL5B            = """></a>"
 EMAIL5C            = ".."
 EMAIL6A            = "<span style=""display: none;""><a href=""mailto:"
 EMAIL6B            = """>"
 EMAIL6C            = "</a></span>"
 EMAIL7A            = "<span style=""display:none;""><a href=""mailto:"
 EMAIL7B            = """>"
 EMAIL7C            = "</a></span>"
 EMAIL8A            = "<!-- <a href=""mailto:"
 EMAIL8B            = """>"
 EMAIL8C            = "</a> -->"
 EMAIL9A            = "<div id=""" & DIV1 & """><a href=""mailto:"
 EMAIL9B            = """>"
 EMAIL9C            = "</a></div><br><script language=""JavaScript"" type=""text/javascript"">document.getElementById('" & DIV1 & "').innerHTML='';</script>"
 EMAIL10A           = "<a href=""mailto:"
 EMAIL10B           = """><!-- "
 EMAIL10C           = " --></a>"
 LEGAL1             = ""
 LEGAL2             = "\n"
 STYLE1             = "\n<style>a." & CLASS_STYLE_1 & "{color:#FFF;font:bold 10px arial,sans-serif;text-decoration:none;}</style>"
 VANITY1            = "<table cellspacing=""0""cellpadding=""0""border=""0""style=""background:#999;width:230px;""><tr><td valign=""top""style=""padding: 1px 2px 5px 4px;border-right:solid 1px #CCC;""><span style=""font:bold 30px arial,sans-serif;color:#666;top:0px;position:relative;"">@</span></td><td valign=""top"" align=""left"" style=""padding:3px 0 0 4px;""><a href=""http://www.projecthoneypot.org/"" class=""" & CLASS_STYLE_1 & """>" & VANITY_L1 & "</a><br><a href=""http://www.unspam.com""class=""" & CLASS_STYLE_1 & """>" & VANITY_L2 & "<br>" & VANITY_L3 & "</a></td></tr></table>\n"
 BOTTOM1            = "</div>\n</body>\n</html>\n"


Function getLegalContent()
    getLegalContent = "<table cellpadding=""0"" border=""0"" cellspacing=""0""><tr>\n<td><tt>&#160; &#160;&#160; <br>&nbsp;<br>&#84;&#104;e w<br>to yo<br>other<br>Webs&#105;<br>read<font color=#FFFFFF>p</font><br>&#97;gent<br>the&#109;.<br>non-&#116;<br>Websi<br><br>&#160; &#160;&#160; <br>&nbsp;<br>Speci<br>No&#110;-&#72;<br>sp&#105;de<br>p&#114;&#111;gr<br>auto&#109;<br><br>E&#109;a&#105;l<br>It is<br>&#97;&#108;one<br>has a<br>st&#111;ra<br>value<br>stori<br>agree<br><br>&#160; &#160;&#160; <br>&nbsp;<br>Each <br>again<br>(""Jud<br>the &#114;<br>such <br>an&#100; p<br>of &#102;e<br>any &#97;<br>&#83;&#101;rv&#105;<br>the &#97;<br><br>&#160; &#160;&#160; <br>&nbsp;<br>You c<br>may a<br>abuse<br>Visit<br><br>VISIT<br>P&#65;RT&#89;<br>SUBS<!-- german intransitive harmony atomic -->&#69;<br></tt></td>\n<td><tt>&nbsp;<b><font color=#FFFFFF>g</font></b>&nbsp;<b><font color=#FFFFFF>h</font></b>&nbsp;<br><br>eb&#115;&#105;t<br>u<font color=#FFFFFF>c</font>sub<br>&nbsp;ter&#109;<br>te yo<br>&#116;hem <br>&#115; of <br>&nbsp;The <br>ransf<br>te&#46;<br><br><b><font color=#FFFFFF>e</font></b>&#160; &#160; <br><br>al re<br>uma&#110; <br>rs, b<br>am&#115; d<br>atica<br><br>&nbsp;addr<br>&nbsp;&#114;&#101;co<br>&#46; &#89;o&#117;<br>&nbsp;val&#117;<br>ge, a<br>&nbsp;of t<br>&#110;g th<br>ment <br><br>&#160; &#160;&#160; <br><br>&#112;&#97;rty<br>&#115;t th<br>icial<br>egist<br>laws <br>erfor<!-- guardian bladder gassy bright --><br>deral<br>ct&#105;on<br>c&#101;&#46; Y<br>bove <br><br>&#160; &#160;&#160; <br><br>onsen<br>ppea&#114;<br>. T&#104;e<br>ors<font color=#FFFFFF>d</font>a<br><br>ORS &#65;<br>&nbsp;OR<font color=#FFFFFF>f</font>S<br>&#81;UENT<br></tt></td>\n<td><tt>&#160; &#160;&#160; <br><br>e fro<br>jec&#116; <br>s gov<br>u acc<br>caref<br>the<!-- corps coarsegrained nutritious -->&nbsp;i<br>&#97;c&#99;es<br>era&#98;l<br><br><br>&#160; &#160;&#160; <br><br>stric<br>Visi&#116;<br>ots,<font color=#FFFFFF>k</font><br>esign<br>lly.<br><br>es&#115;es<br>gniz&#101;<br>&nbsp;&#97;ckn<br>e no&#116;<br>nd/or<br>h&#101;se <br>is &#87;e<br>and e<br><br>&#160; &#160; <b><font color=#FFFFFF>c</font></b><br><br>&nbsp;agr&#101;<br>&#101; oth<br><font color=#FFFFFF>i</font>Act&#105;<br>ered <br>&#97;&#114;e a<br>med e<br><font color=#FFFFFF>d</font>a&#110;d<font color=#FFFFFF>o</font><br>&nbsp;&#98;rou<br>ou c&#111;<br>agree<br><br>&#160; <b><font color=#FFFFFF>p</font></b>&#160; <br><br>t to <br>&nbsp;so&#109;e<br>&nbsp;Iden<br>gree <br><br>GR&#69;&#69; <br>END&#73;&#78;<br><font color=#FFFFFF>k</font>BR&#69;&#65;<br></tt></td>\n<td><tt>&#160; &#160;&#160; <br><br>&#109; whi<br>t&#111; th<br>ernin<br>ept t<br>u&#108;ly.<br>ndivi<br>s ri&#103;<br>e<font color=#FFFFFF>i</font>wit<br><br><br><b>SP&#69;CI</b><br><br>tions<br>ors&#46;<font color=#FFFFFF>t</font><br>in&#100;ex<br>ed to<br><br><br>&nbsp;on t<br>d tha<br>owled<br>&nbsp;less<br>&nbsp;dis&#116;<br>addr&#101;<br>bsite<br>&#120;pres<br><br>&#160; &#160;&#160; <br><br>&#101;s th<br>er &#105;n<br>on""&#41; <br>A&#100;&#109;&#105;n<br>pp&#108;ie<br>ntire<!-- ablaze temporal professional --><br>st&#97;t<!-- freshman adult general gays wicked -->&#101;<br>ght a<br>n&#115;ent<br>men&#116;.<br><br>&nbsp;<b><font color=#FFFFFF>f</font></b>&#160;&#160; <br><br>&#104;a&#118;in<br>wher<!-- witches immanent multiparous safety -->&#101;<br>tifie<br>n<!-- underwater triumph zany faultfinding -->&#111;t t<br><br>THAT <br>&#71; ANY<br>CH<font color=#FFFFFF>g</font>O&#70;<br></tt></td>\n<td><tt>&#160; <b><font color=#FFFFFF>o</font></b>&#160; <br><br>ch yo<br>e fol<br>g a&#99;c<br>&#104;ese<font color=#FFFFFF>e</font><br>&nbsp;&#65;ny <br>dual(<br>&#104;&#116;&#115; g<br>hout <br><br><br><b>AL</b>&nbsp;<b>LI</b><br><br>&nbsp;on &#97;<br>Non&#45;H<br>ers&#44;<font color=#FFFFFF>h</font><br><font color=#FFFFFF>p</font>&#97;cc&#101;<br><br><br>&#104;i&#115; s<br>t th&#101;<br>ge an<br>&nbsp;than<br>ri<!-- rhythmic burial petrol insurance delicious -->&#98;ut<br>sse&#115;.<br>'s em<br>sly p<br><br>&#160; &#160; <b><font color=#FFFFFF>d</font></b><br><br>at an<br>&nbsp;conn<br>shall<br>istra<br>d<font color=#FFFFFF>t</font>to <br>ly w&#105;<br><font color=#FFFFFF>i</font>&#99;our<br>&#103;&#97;ins<br>&nbsp;to e<br><br><br><b><font color=#FFFFFF>h</font></b>&#160; <b><font color=#FFFFFF>h</font>R</b><br><br>g you<br>&nbsp;on t<br>&#114; is <br>&#111; use<br><br>HA&#82;VE<br>&nbsp;&#77;ES&#83;<br>&nbsp;THES<br></tt></td>\n<td><tt>&nbsp;<b><font color=#FFFFFF>h</font>TER</b><br><br>&#117;<font color=#FFFFFF>k</font>acc<br>low<!-- sonant landmark occlusion conversion -->in<br>&#101;s&#115; t<br>terms<br>No<!-- valuable -->n-&#72;<br>s) w&#104;<br>&#114;ante<br>the e<br><br><br><b>CENSE</b><br><br>&nbsp;v&#105;si<br>uman <br>robot<br>ss, r<br><br><br>i&#116;e a<br>s&#101; em<br>d agr<br>&nbsp;US $<br>&#105;on o<br>&nbsp;Inte<br>ail a<br>rohib<br><br><b>AP&#80;LI</b><br><br>y<font color=#FFFFFF>p</font>s&#117;i<br>&#101;c&#116;&#105;o<br>&nbsp;be g<br>&#116;ive <br>agree<br>thin<font color=#FFFFFF>d</font><br>ts wi<br>&#116; him<br>lect&#114;<br><br><br><b>EC&#79;RD</b><br><br>r I&#110;t<br>his p<br>un&#105;qu<br>&nbsp;&#116;&#104;&#105;s<br><br>STIN&#71;<br>AG<!-- flock housebroken introduction presidential investigation -->E(S<br>E T&#69;R<br></tt></td>\n<td><tt><b>MS</b>&nbsp;<b>&#65;N</b><br><br>essed<br>g<font color=#FFFFFF>g</font>con<br>o the<br>&nbsp;and <br>uma<!-- percentage pearly zippy alternative -->n <br>o con<!-- oceangoing inveterate union major --><br>d to<font color=#FFFFFF>o</font><br>&#120;pres<br><br><br>&nbsp;<b>REST</b><br><br>tor's<br>Vis<!-- maverick torpor prayer lentissimo yellow -->it<br>s, cr<br>ead, <br><br><br>re<font color=#FFFFFF>s</font>co<br>a&#105;l a<br>ee th<br>50. Y<br>&#102;<font color=#FFFFFF>k</font>the<br>ntion<br>dd&#114;es<br>ited.<br><br><b>CABLE</b><br><br>t, ac<br>n wit<br>&#111;vern<br>Con&#116;a<br>ments<br>the A<br>thin <br>&nbsp;in c<br>onic <br><br><br><b>&#83;</b>&nbsp;<b>O<!-- comic power -->F</b>&nbsp;<br><br>erne&#116;<br>a&#103;e (<br>ely m<br>&nbsp;addr<br><br>, GAT<br>&#41; TO<font color=#FFFFFF>e</font><br>MS O&#70;<br></tt></td>\n<td><tt><b>D</b>&nbsp;<b>&#67;ON</b><br><br>&nbsp;t&#104;is<br>d&#105;tio<br>&nbsp;W&#101;bs<br>con<!-- location refusal -->di<br>Vis&#105;t<br>t&#114;o&#108;s<br>you u<br>s &#119;ri<br><br><br><b>RICTI</b><br><br>&nbsp;lice<br>&#111;rs &#105;<br>awler<br>compi<br><br><br>nside<br>ddres<br>at ea<br>&#111;u f&#117;<br>se ad<br>al co<br>ses i<br><br><br>&nbsp;<b>LAW</b>&nbsp;<br><br>tion<font color=#FFFFFF>c</font><br>h or <br>e&#100;<font color=#FFFFFF>k</font>by<br>ct (t<br>&nbsp;betw<br>dmin <br>&#116;he A<br>o&#110;nec<br>serv&#105;<br><br><br><b>VISIT</b><br><br>&nbsp;Prot<br>the ""<br>a&#116;c&#104;&#101;<br>ess<font color=#FFFFFF>o</font>f<br><br>HERIN<br>T&#72;&#69;<font color=#FFFFFF>k</font>&#73;<br>&nbsp;SERV<br></tt></td>\n<td><tt><b>DITIO</b><br><br>&nbsp;a&#103;re<br>ns. T<br>ite.<!-- no -->&nbsp;<br>tions<br>ors t<br>&#44; aut<br>nder<!-- calculous diminuendo -->&nbsp;<br>tten <br><br><br><b>O&#78;S</b>&nbsp;<b>F</b><br><br>n&#115;e t<br>nclu&#100;<br>&#115;, ha<br>le o<!-- immigration -->r<br><br><br>re&#100; &#112;<br>&#115;&#101;&#115; a<br>ch em<br>rth&#101;&#114;<br>d&#114;ess<br>llect<br>&#115; r<!-- nucleate -->ec<br><br><br><b>AND</b>&nbsp;<b>J</b><br><br>o&#114; pr<br>ar&#105;si<br>&nbsp;th&#101; <br>he<font color=#FFFFFF>s</font>""&#65;<br>ee&#110; A<br>Stat&#101;<br>&#100;min <br>tion <br>c<!-- guillemots salmon victorious critical wired -->e of<br><br><br><b>OR</b>&nbsp;<b>US</b><br><br>ocol <br>Ident<br>d to <br>or an<br><br>G, S&#84;<br>D&#69;NTI<br>ICE.<br></tt></td>\n<td><tt><b>NS</b>&nbsp;<b>&#79;F</b><br><br>e&#109;&#101;nt<br>h&#101;s&#101;<font color=#FFFFFF>a</font><br>By<font color=#FFFFFF>o</font>v&#105;<br>&nbsp;(the<br>o the<br>hor&#115; <br>th&#101; T<br>&#112;er<!-- telegram preventive sensitive tabulate martial -->mi<br><br><br><b>OR</b>&nbsp;<b>NO</b><br><br>o a&#99;c<br>e,<font color=#FFFFFF>i</font>bu<br>r&#118;e&#115;&#116;<br>&nbsp;gath<br><br><br>rop&#114;i<br>re p&#114;<br>ail &#97;<br>&nbsp;agre<br>es su<br>ion, <br>&#111;gniz<br><br><br><b>URISD</b><br><br>o&#99;eed<br>ng &#102;r<br>&#108;aw o<br>dm&#105;n <br>d&#109;in <br>. Y&#111;&#117;<br>State<br>&#119;ith <br>&nbsp;proc<br><br><br><b>E</b>&nbsp;<b>AND</b><br><br>addre<br>&#105;fier<br>your <br>y rea<br><br>ORING<br>&#70;IER <br><br></tt></td>\n<td><tt>&nbsp;<b>USE<font color=#FFFFFF>s</font></b><br><br>&nbsp;(""th<br>terms<br>siti&#110;<br>&nbsp;""Ter<br>&nbsp;W&#101;bs<br>or ot<br>er&#109;s <br>ssion<br><br><br><b>N-HUM</b><br><br>ess<font color=#FFFFFF>e</font>t<br>&#116; are<br>ers&#44; <br>er &#99;o<br><br><br>e&#116;&#97;&#114;y<!-- precise --><br>ovide<br>ddres<br>e tha<br>bstan<br>ha&#114;ve<br>ed as<br><br><br><b>ICTIO</b><br><br>in&#103;<font color=#FFFFFF>k</font>b<br>om th<br>f the<br>State<br>State<br>&nbsp;cons<br>. You<br>br&#101;&#97;c<br>ess r<br><br><br>&nbsp;<b>A&#66;US</b><br><br>ss re<br>""&#41; if<br>Inter<br>s&#111;n.<br><br>, T&#82;A<br>CONS&#84;<br><br></tt></td>\n<td><tt><br><br>e W<!-- electromotive benign religion moderate -->eb<br><font color=#FFFFFF>s</font>are <br>g (i&#110;<br>ms of<br>ite s<br>herw&#105;<br>o<!-- ingredient radiate boiling ancestor vacuumpacked -->f &#83;e<br>&nbsp;of t<br><br><br><b>AN</b>&nbsp;<b>VI</b><br><br>he We<br>&nbsp;not <br>or a<!-- painful -->&#110;<br>ntent<br><br><br>&nbsp;in&#116;e<br>d for<br>s the<!-- deltoid homing kindhearted --><br>t the<br>tiall<br>&#115;tin&#103;<br>&nbsp;a v&#105;<br><br><br><b>N</b>&nbsp;<br><br>roug&#104;<br>e Te<!-- itching gobelin -->r<br>&nbsp;&#115;tat<br>"") fo<br>&nbsp;resi<br>ent t<br>&nbsp;&#99;o&#110;s<br>hes o<br>&#101;&#103;ard<br><br><br><b>E</b>&nbsp;<br><br>corde<br>&nbsp;we<font color=#FFFFFF>g</font>s<br>n&#101;t P<br><br><br>&#78;SFER<br>ITUTE<br><br></tt></td>\n<td><tt><br><br>site""<br>in ad<br>&nbsp;&#97;n&#121; <br>&nbsp;Serv<br>&#104;a&#108;&#108; <br>se ma<br>rv&#105;ce<br>he ow<br><br><br><b>SITOR</b><br><br>bsite<br>l&#105;mit<br>y o&#116;&#104;<br><font color=#FFFFFF>i</font>from<br><br><br>llect<!-- fraction lemon mysterious electric --><br>&nbsp;hu&#109;a<br>&nbsp;We&#98;&#115;<br>&nbsp;co&#109;p<br>y d&#105;m<br>, gat<br>olati<br><br><br><br><br>&#116; by <br>ms o&#102;<br>&#101; of <br>r the<br>dents<br>o t&#104;e<br>en&#116; t<br>f &#116;h&#101;<br>i&#110;&#103; a<br><br><br><br><br>d. An<br>&#117;sp&#101;c<br>rotoc<br><br><br>&#82;IN&#71; <br>S AN <br><br></tt></td>\n<td><tt><br><br>) &#105;s <br>ditio<br>manne<br>ice"")<br>be co<br>&#107;es &#117;<br><font color=#FFFFFF>g</font>a&#114;e<br>ner o<br><br><br><b>S</b>&nbsp;<br><br>&nbsp;app&#108;<br>ed to<br>er co<br>&nbsp;the <br><br><br>ual p<br>n<font color=#FFFFFF>p</font>vis<br>ite &#99;<br>il&#97;ti<br>inish<br>herin<br>on of<br><br><br><br><br>such <br>&nbsp;Serv<br>resid<br>&nbsp;&#87;eb&#115;<br>&nbsp;ente<br>&nbsp;jur&#105;<br>o the<br>&#115;e T&#101;<br>ctio&#110;<br><br><br><br><br>&nbsp;emai<br>t &#112;ot<br>ol a<!-- dative assurance cognate -->d<br><br><br>TO A <br>ACCEP<br><br></tt></td>\n<td><tt><br><br>prov&#105;<br>n to <br>r) th<br>. Ple<br>nsid&#101;<br>se of<br><br>f &#116;he<br><br><br><br><br>y to<br>, web<br>&#109;pute<br>Websi<br><br><br>roper<br>itors<br>o&#110;tai<br>on,<br>es th<br>g, an<br>&nbsp;this<br><br><br><br><br>party<br>ice<br>&#101;nc<!-- useful confusion diagrammatic stinky basin -->e <br>it&#101; a<br>&#114;ed i<br>sdict<br><font color=#FFFFFF>c</font>ven&#117;<br>rms o<br>s und<br><br><br><br><br>l add<br>enti&#97;<br>dress<br><br><br>THIRD<!-- resonant internecine --><br>TANCE<br><br></tt></td>\n<td><tt><br><br>ded<br>any<br>e<br>ase<br>&#114;&#101;d<br><br><br><br><br><br><br><br><br><br>r<br>te<br><br><br>ty.<br><br>ns<br><br>e<br>d/or<br><br><br><br><br><br><br><br>of<br>s<br>nto<br>ion<br>&#101; in<br>f<br>&#101;r<br><br><br><br><br>ress<br>l<br>.<br><br><br><br>&nbsp;AND<br><br></tt></td>\n</tr>\n</table>\n<br>"
End Function




Private Const BITS_TO_A_BYTE = 8
Private Const BYTES_TO_A_WORD = 4
Private Const BITS_TO_A_WORD = 32

Private m_lOnBits(30)
Private m_l2Power(30)
 
    m_lOnBits(0) = CLng(1)
    m_lOnBits(1) = CLng(3)
    m_lOnBits(2) = CLng(7)
    m_lOnBits(3) = CLng(15)
    m_lOnBits(4) = CLng(31)
    m_lOnBits(5) = CLng(63)
    m_lOnBits(6) = CLng(127)
    m_lOnBits(7) = CLng(255)
    m_lOnBits(8) = CLng(511)
    m_lOnBits(9) = CLng(1023)
    m_lOnBits(10) = CLng(2047)
    m_lOnBits(11) = CLng(4095)
    m_lOnBits(12) = CLng(8191)
    m_lOnBits(13) = CLng(16383)
    m_lOnBits(14) = CLng(32767)
    m_lOnBits(15) = CLng(65535)
    m_lOnBits(16) = CLng(131071)
    m_lOnBits(17) = CLng(262143)
    m_lOnBits(18) = CLng(524287)
    m_lOnBits(19) = CLng(1048575)
    m_lOnBits(20) = CLng(2097151)
    m_lOnBits(21) = CLng(4194303)
    m_lOnBits(22) = CLng(8388607)
    m_lOnBits(23) = CLng(16777215)
    m_lOnBits(24) = CLng(33554431)
    m_lOnBits(25) = CLng(67108863)
    m_lOnBits(26) = CLng(134217727)
    m_lOnBits(27) = CLng(268435455)
    m_lOnBits(28) = CLng(536870911)
    m_lOnBits(29) = CLng(1073741823)
    m_lOnBits(30) = CLng(2147483647)
    
    m_l2Power(0) = CLng(1)
    m_l2Power(1) = CLng(2)
    m_l2Power(2) = CLng(4)
    m_l2Power(3) = CLng(8)
    m_l2Power(4) = CLng(16)
    m_l2Power(5) = CLng(32)
    m_l2Power(6) = CLng(64)
    m_l2Power(7) = CLng(128)
    m_l2Power(8) = CLng(256)
    m_l2Power(9) = CLng(512)
    m_l2Power(10) = CLng(1024)
    m_l2Power(11) = CLng(2048)
    m_l2Power(12) = CLng(4096)
    m_l2Power(13) = CLng(8192)
    m_l2Power(14) = CLng(16384)
    m_l2Power(15) = CLng(32768)
    m_l2Power(16) = CLng(65536)
    m_l2Power(17) = CLng(131072)
    m_l2Power(18) = CLng(262144)
    m_l2Power(19) = CLng(524288)
    m_l2Power(20) = CLng(1048576)
    m_l2Power(21) = CLng(2097152)
    m_l2Power(22) = CLng(4194304)
    m_l2Power(23) = CLng(8388608)
    m_l2Power(24) = CLng(16777216)
    m_l2Power(25) = CLng(33554432)
    m_l2Power(26) = CLng(67108864)
    m_l2Power(27) = CLng(134217728)
    m_l2Power(28) = CLng(268435456)
    m_l2Power(29) = CLng(536870912)
    m_l2Power(30) = CLng(1073741824)

Private Function LShift(lValue, iShiftBits)
    If iShiftBits = 0 Then
        LShift = lValue
        Exit Function
    ElseIf iShiftBits = 31 Then
        If lValue And 1 Then
            LShift = &H80000000
        Else
            LShift = 0
        End If
        Exit Function
    ElseIf iShiftBits < 0 Or iShiftBits > 31 Then
        Err.Raise 6
    End If

    If (lValue And m_l2Power(31 - iShiftBits)) Then
        LShift = ((lValue And m_lOnBits(31 - (iShiftBits + 1))) * m_l2Power(iShiftBits)) Or &H80000000
    Else
        LShift = ((lValue And m_lOnBits(31 - iShiftBits)) * m_l2Power(iShiftBits))
    End If
End Function

Private Function RShift(lValue, iShiftBits)
    If iShiftBits = 0 Then
        RShift = lValue
        Exit Function
    ElseIf iShiftBits = 31 Then
        If lValue And &H80000000 Then
            RShift = 1
        Else
            RShift = 0
        End If
        Exit Function
    ElseIf iShiftBits < 0 Or iShiftBits > 31 Then
        Err.Raise 6
    End If
    
    RShift = (lValue And &H7FFFFFFE) \ m_l2Power(iShiftBits)

    If (lValue And &H80000000) Then
        RShift = (RShift Or (&H40000000 \ m_l2Power(iShiftBits - 1)))
    End If
End Function

Private Function RotateLeft(lValue, iShiftBits)
    RotateLeft = LShift(lValue, iShiftBits) Or RShift(lValue, (32 - iShiftBits))
End Function

Private Function AddUnsigned(lX, lY)
    Dim lX4
    Dim lY4
    Dim lX8
    Dim lY8
    Dim lResult
 
    lX8 = lX And &H80000000
    lY8 = lY And &H80000000
    lX4 = lX And &H40000000
    lY4 = lY And &H40000000
 
    lResult = (lX And &H3FFFFFFF) + (lY And &H3FFFFFFF)
 
    If lX4 And lY4 Then
        lResult = lResult Xor &H80000000 Xor lX8 Xor lY8
    ElseIf lX4 Or lY4 Then
        If lResult And &H40000000 Then
            lResult = lResult Xor &HC0000000 Xor lX8 Xor lY8
        Else
            lResult = lResult Xor &H40000000 Xor lX8 Xor lY8
        End If
    Else
        lResult = lResult Xor lX8 Xor lY8
    End If
 
    AddUnsigned = lResult
End Function

Private Function F(x, y, z)
    F = (x And y) Or ((Not x) And z)
End Function

Private Function G(x, y, z)
    G = (x And z) Or (y And (Not z))
End Function

Private Function H(x, y, z)
    H = (x Xor y Xor z)
End Function

Private Function I(x, y, z)
    I = (y Xor (x Or (Not z)))
End Function

Private Sub FF(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(F(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Sub GG(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(G(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Sub HH(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(H(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Sub II(a, b, c, d, x, s, ac)
    a = AddUnsigned(a, AddUnsigned(AddUnsigned(I(b, c, d), x), ac))
    a = RotateLeft(a, s)
    a = AddUnsigned(a, b)
End Sub

Private Function ConvertToWordArray(sMessage)
    Dim lMessageLength
    Dim lNumberOfWords
    Dim lWordArray()
    Dim lBytePosition
    Dim lByteCount
    Dim lWordCount
    
    Const MODULUS_BITS = 512
    Const CONGRUENT_BITS = 448
    
    lMessageLength = Len(sMessage)
    
    lNumberOfWords = (((lMessageLength + ((MODULUS_BITS - CONGRUENT_BITS) \ BITS_TO_A_BYTE)) \ (MODULUS_BITS \ BITS_TO_A_BYTE)) + 1) * (MODULUS_BITS \ BITS_TO_A_WORD)
    ReDim lWordArray(lNumberOfWords - 1)
    
    lBytePosition = 0
    lByteCount = 0
    Do Until lByteCount >= lMessageLength
        lWordCount = lByteCount \ BYTES_TO_A_WORD
        lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE
        lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(Asc(Mid(sMessage, lByteCount + 1, 1)), lBytePosition)
        lByteCount = lByteCount + 1
    Loop

    lWordCount = lByteCount \ BYTES_TO_A_WORD
    lBytePosition = (lByteCount Mod BYTES_TO_A_WORD) * BITS_TO_A_BYTE

    lWordArray(lWordCount) = lWordArray(lWordCount) Or LShift(&H80, lBytePosition)

    lWordArray(lNumberOfWords - 2) = LShift(lMessageLength, 3)
    lWordArray(lNumberOfWords - 1) = RShift(lMessageLength, 29)
    
    ConvertToWordArray = lWordArray
End Function

Private Function WordToHex(lValue)
    Dim lByte
    Dim lCount
    
    For lCount = 0 To 3
        lByte = RShift(lValue, lCount * BITS_TO_A_BYTE) And m_lOnBits(BITS_TO_A_BYTE - 1)
        WordToHex = WordToHex & Right("0" & Hex(lByte), 2)
    Next
End Function

Public Function MD5(sMessage)
    Dim x
    Dim k
    Dim AA
    Dim BB
    Dim CC
    Dim DD
    Dim a
    Dim b
    Dim c
    Dim d
    
    Const S11 = 7
    Const S12 = 12
    Const S13 = 17
    Const S14 = 22
    Const S21 = 5
    Const S22 = 9
    Const S23 = 14
    Const S24 = 20
    Const S31 = 4
    Const S32 = 11
    Const S33 = 16
    Const S34 = 23
    Const S41 = 6
    Const S42 = 10
    Const S43 = 15
    Const S44 = 21

    x = ConvertToWordArray(sMessage)
    
    a = &H67452301
    b = &HEFCDAB89
    c = &H98BADCFE
    d = &H10325476

    For k = 0 To UBound(x) Step 16
        AA = a
        BB = b
        CC = c
        DD = d
    
        FF a, b, c, d, x(k + 0), S11, &HD76AA478
        FF d, a, b, c, x(k + 1), S12, &HE8C7B756
        FF c, d, a, b, x(k + 2), S13, &H242070DB
        FF b, c, d, a, x(k + 3), S14, &HC1BDCEEE
        FF a, b, c, d, x(k + 4), S11, &HF57C0FAF
        FF d, a, b, c, x(k + 5), S12, &H4787C62A
        FF c, d, a, b, x(k + 6), S13, &HA8304613
        FF b, c, d, a, x(k + 7), S14, &HFD469501
        FF a, b, c, d, x(k + 8), S11, &H698098D8
        FF d, a, b, c, x(k + 9), S12, &H8B44F7AF
        FF c, d, a, b, x(k + 10), S13, &HFFFF5BB1
        FF b, c, d, a, x(k + 11), S14, &H895CD7BE
        FF a, b, c, d, x(k + 12), S11, &H6B901122
        FF d, a, b, c, x(k + 13), S12, &HFD987193
        FF c, d, a, b, x(k + 14), S13, &HA679438E
        FF b, c, d, a, x(k + 15), S14, &H49B40821
    
        GG a, b, c, d, x(k + 1), S21, &HF61E2562
        GG d, a, b, c, x(k + 6), S22, &HC040B340
        GG c, d, a, b, x(k + 11), S23, &H265E5A51
        GG b, c, d, a, x(k + 0), S24, &HE9B6C7AA
        GG a, b, c, d, x(k + 5), S21, &HD62F105D
        GG d, a, b, c, x(k + 10), S22, &H2441453
        GG c, d, a, b, x(k + 15), S23, &HD8A1E681
        GG b, c, d, a, x(k + 4), S24, &HE7D3FBC8
        GG a, b, c, d, x(k + 9), S21, &H21E1CDE6
        GG d, a, b, c, x(k + 14), S22, &HC33707D6
        GG c, d, a, b, x(k + 3), S23, &HF4D50D87
        GG b, c, d, a, x(k + 8), S24, &H455A14ED
        GG a, b, c, d, x(k + 13), S21, &HA9E3E905
        GG d, a, b, c, x(k + 2), S22, &HFCEFA3F8
        GG c, d, a, b, x(k + 7), S23, &H676F02D9
        GG b, c, d, a, x(k + 12), S24, &H8D2A4C8A
            
        HH a, b, c, d, x(k + 5), S31, &HFFFA3942
        HH d, a, b, c, x(k + 8), S32, &H8771F681
        HH c, d, a, b, x(k + 11), S33, &H6D9D6122
        HH b, c, d, a, x(k + 14), S34, &HFDE5380C
        HH a, b, c, d, x(k + 1), S31, &HA4BEEA44
        HH d, a, b, c, x(k + 4), S32, &H4BDECFA9
        HH c, d, a, b, x(k + 7), S33, &HF6BB4B60
        HH b, c, d, a, x(k + 10), S34, &HBEBFBC70
        HH a, b, c, d, x(k + 13), S31, &H289B7EC6
        HH d, a, b, c, x(k + 0), S32, &HEAA127FA
        HH c, d, a, b, x(k + 3), S33, &HD4EF3085
        HH b, c, d, a, x(k + 6), S34, &H4881D05
        HH a, b, c, d, x(k + 9), S31, &HD9D4D039
        HH d, a, b, c, x(k + 12), S32, &HE6DB99E5
        HH c, d, a, b, x(k + 15), S33, &H1FA27CF8
        HH b, c, d, a, x(k + 2), S34, &HC4AC5665
    
        II a, b, c, d, x(k + 0), S41, &HF4292244
        II d, a, b, c, x(k + 7), S42, &H432AFF97
        II c, d, a, b, x(k + 14), S43, &HAB9423A7
        II b, c, d, a, x(k + 5), S44, &HFC93A039
        II a, b, c, d, x(k + 12), S41, &H655B59C3
        II d, a, b, c, x(k + 3), S42, &H8F0CCC92
        II c, d, a, b, x(k + 10), S43, &HFFEFF47D
        II b, c, d, a, x(k + 1), S44, &H85845DD1
        II a, b, c, d, x(k + 8), S41, &H6FA87E4F
        II d, a, b, c, x(k + 15), S42, &HFE2CE6E0
        II c, d, a, b, x(k + 6), S43, &HA3014314
        II b, c, d, a, x(k + 13), S44, &H4E0811A1
        II a, b, c, d, x(k + 4), S41, &HF7537E82
        II d, a, b, c, x(k + 11), S42, &HBD3AF235
        II c, d, a, b, x(k + 2), S43, &H2AD7D2BB
        II b, c, d, a, x(k + 9), S44, &HEB86D391
    
        a = AddUnsigned(a, AA)
        b = AddUnsigned(b, BB)
        c = AddUnsigned(c, CC)
        d = AddUnsigned(d, DD)
    Next
    
    MD5 = LCase(WordToHex(a) & WordToHex(b) & WordToHex(c) & WordToHex(d))
End Function
                    
Function getFileContents(ByRef Filepath)

   Const ForReading = 1
   Const TristateUseDefault = -2
   
   Dim FSO
   set FSO = server.createObject("Scripting.FileSystemObject")
   
   if FSO.FileExists(Filepath) Then
      Set TextStream = FSO.OpenTextFile(Filepath, ForReading, False, TristateUseDefault)
      Dim Contents
   	  Contents = TextStream.ReadAll
   	  'Response.write("<pre>" & Contents & "</pre>")
      TextStream.Close
   	  Set TextStream = nothing
   Else
      Response.Write("<font color=""red"">WARNING: File " & Filepath & " could not be read!</font>")
      getFileContents = nothing
      exit function 
   
   End If
   
   Set FSO = nothing

   getFileContents = Contents
End Function

Function getDocType() 
	getDocType = DOC_TYPE1
End Function

Function getHeadHTML1() 
	getHeadHTML1 = HEAD1
End Function

Function getRobotHTML() 
	getRobotHTML = ROBOT1
End Function

Function getNoCollectHTML() 
	getNoCollectHTML = NOCOLLECT1
End Function
 
Function getHeadHTML2() 
	getHeadHTML2 = HEAD2
End Function

Function getTopHTML() 
	getTopHTML = TOP1
End Function
 
Function getEmailHTML(Method, Email)
	Select Case Method
		Case 0:
			getEmailHTML = ""
		Case 1:
			getEmailHTML = EMAIL1A & Email & EMAIL1B & Email & EMAIL1C
		Case 2:
			getEmailHTML = EMAIL2A & Email & EMAIL2B & Email & EMAIL2C
		Case 3:
			getEmailHTML = EMAIL3A & Email & EMAIL3B & Email & EMAIL3C
		Case 4:
			getEmailHTML = EMAIL4A & Email & EMAIL4B & Email & EMAIL4C
		Case 5:
			getEmailHTML = EMAIL5A & Email & EMAIL5B & Email & EMAIL5C
		Case 6:
			getEmailHTML = EMAIL6A & Email & EMAIL6B & Email & EMAIL6C
		Case 7:
			getEmailHTML = EMAIL7A & Email & EMAIL7B & Email & EMAIL7C
		Case 8:
			getEmailHTML = EMAIL8A & Email & EMAIL8B & Email & EMAIL8C
		Case 9:
			getEmailHTML = EMAIL9A & Email & EMAIL9B & Email & EMAIL9C
        case Else:
			getEmailHTML = EMAIL10A & Email & EMAIL10B & Email & EMAIL10C
	End Select
End Function

Function getLegalHTML
	getLegalHTML = LEGAL1 & getLegalContent() & LEGAL2
End Function

Function getStyleHTML
	getStyleHTML = STYLE1
End Function

Function getVanityHTML
	getVanityHTML = VANITY1
End Function

Function getBottomHTML
	getBottomHTML = BOTTOM1
End Function

Function performRequest(Request) 
	ResponseStr = ""
	URL = ""
	
	Set srvXmlHttp = Server.CreateObject("MICROSOFT.XMLHTTP")
	
	URL = "http://" & REQUEST_HOST & REQUEST_SCRIPT
    
	srvXmlHttp.open "POST", URL, false
	srvXmlHttp.setRequestHeader "Cache-Control", "no-cache"
	srvXmlHttp.setRequestHeader "User-Agent", "PHPot " & HPOT_TAG2
	srvXmlHttp.setRequestHeader "Content-Type", "application/x-www-form-urlencoded"
	srvXmlHttp.setRequestHeader "Connection", "close"
    srvXmlHttp.send Request
    
    performRequest = srvXmlHttp.responseText
End Function

Function prepareRequest() 
	Set postvars = CreateObject("Scripting.Dictionary")

	postvars.Add "tag1", HPOT_TAG1
	postvars.Add "tag2", HPOT_TAG2
	postvars.Add "tag3", HPOT_TAG3
	postvars.Add "tag4", md5(getFileContents(Request.ServerVariables("PATH_TRANSLATED")))
	postvars.Add "ip", Server.URLEncode(Request.ServerVariables("REMOTE_ADDR"))
	postvars.Add "svrn", Server.URLEncode(Request.ServerVariables("SERVER_NAME"))
	postvars.Add "svp", Server.URLEncode(Request.ServerVariables("SERVER_PORT"))
	postvars.Add "svip", Server.URLEncode(Request.ServerVariables("SERVER_ADDR"))
	postvars.Add "rquri", Server.URLEncode(Request.ServerVariables("URL"))
	postvars.Add "sn", Replace(Server.URLEncode(Request.ServerVariables("SCRIPT_NAME")), " ", "%20")
	postvars.Add "ref", Server.URLEncode(Request.ServerVariables("HTTP_REFERER"))
	postvars.Add "uagnt", Server.URLEncode(Request.ServerVariables("HTTP_USER_AGENT"))
	
	Set prepareRequest = postvars
End Function

Function transcribeResponse(ByVal response)
	Set settings = CreateObject("Scripting.Dictionary")
	Arr = Split(URLDecode(response), Chr(10))
	isParam = false

    
    For j = 0 to UBound(Arr)
		If Arr(j) = "<END>" Then isParam = false
		
		If isParam Then
			pieces = Split(Arr(j), "=", 2)
			If UBound(pieces) = 1 Then
				settings.Add pieces(0), pieces(1)
			End If
		End If
		
		If Arr(j) = "<BEGIN>" Then isParam = true
		
    Next
    
    
    If settings.Exists("directives") Then
		settings.Item("directives") = Split(settings.Item("directives"), ",")
    End If
    
    Set transcribeResponse = settings
End Function

Function URLDecode(ByRef str)	
	Set re = New RegExp
	str = Replace(str, "+", " ")
	re.Pattern = "%([0-9a-fA-F]{2})"
	re.Global = True
	URLDecode = re.Replace(str, GetRef("URLDecodeHex"))
End Function

Function URLDecodeHex(match, hex_digits, pos, source)	
	URLDecodeHex = chr("&H" & hex_digits)
End Function

Function formatHTML(ByRef str)
	formatHTML = Replace(str, "\n", VBCrLf)
End Function

Function echo(ByRef str)
	Response.Write(formatHTML(str))
End Function
    
RequestText = ""
ResponseText = ""
Set Post = prepareRequest

Items = Post.Items
Keys = Post.Keys
For j = 0 to Post.Count -1
	RequestText = RequestText & "&" & Keys(j) & "=" & Items(j)
Next

RequestText = Mid(RequestText, 2)
ResponseText = performRequest(RequestText)
Set settings = transcribeResponse(ResponseText)

directives = settings.Item("directives")
email = settings.Item("email")
emailmethod = settings.Item("emailmethod")

Response.AddHeader "Cache-Control", "no-cache"


%>

<% If directives(0) And directives(0) = "1" Then echo(getDocType)%>
<% If settings("injDocType") Then echo(settings("injDocTypeMsg"))%>
<% If directives(1) And directives(1) = "1" Then echo(getHeadHTML1)%>
<% If settings("injHead1HTML") Then echo(settings("injHead1HTMLMsg"))%>
<% If directives(8) And directives(8) = "1" Then echo(getRobotHTML)%>
<% If settings("injRobotHTML") Then echo(settings("injRobotHTMLMsg"))%>
<% If directives(9) And directives(9) = "1" Then echo(getNoCollectHTML)%>
<% If settings("injNoCollectHTML") Then echo(settings("injNoCollectHTMLMsg"))%>
<% If directives(1) And directives(1) = "1" Then echo(getHeadHTML2)%>
<% If settings("injHead2HTML") Then echo(settings("injHead2HTMLMsg"))%>
<% If directives(2) And directives(2) = "1" Then echo(getTopHTML)%>
<% If settings("injTopHTML") Then echo(settings("injTopHTMLMsg"))%>
<%
   IF settings("actMsgOn") <> "" Then echo(settings("actMsg"))
    
   IF settings("errMsgOn") <> "" Then echo(settings("errMsg"))

   IF settings("customMsgOn") <> "" Then echo(settings("customMsg"))
%>
<% If directives(3) And directives(3) = "1" Then echo(getLegalHTML)%>
<% If settings("injLegalHTML") Then echo(settings("injLegalHTMLMsg"))%>
<%
   IF settings("altLegalOn") <> "" Then echo(settings("altLegalMsg"))
%>

<% If directives(4) And directives(4) = "1" Then echo(getEmailHTML(emailmethod, email))%>
<% If settings("injEmailHTML") Then echo(settings("injEmailHTMLMsg"))%>
<% If directives(5) And directives(5) = "1" Then echo(getStyleHTML)%>
<% If settings("injStyleHTML") Then echo(settings("injStyleHTMLMsg"))%>
<% If directives(6) And directives(6) = "1" Then echo(getVanityHTML)%>
<% If settings("injVanityHTML") Then echo(settings("injVanityHTMLMsg"))%>
<%
   IF settings("altVanityOn") <> "" Then echo(settings("altVanityMsg"))
%>
<% If directives(7) And directives(7) = "1" Then echo(getBottomHTML)%>
<% If settings("injBottomHTML") Then echo(settings("injBottomHTMLMsg"))%>
